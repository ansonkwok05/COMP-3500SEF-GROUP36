<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Tracking</title>
    <link rel="stylesheet" href="./status.css">

</head>
<body>
    <div class="container">
        <h1>My orders</h1>
        <div id="orders"></div>
        <div id="error-message" class="error"></div>
    </div>

    <script>
        async function fetchOrders() {
            try {
                const userResponse = await fetch('/api/get_user_id');
                if (userResponse.ok) {
                    const userData = await userResponse.json();
                    userID = userData.userID;
                }
                const response = await fetch('/api/orders?user_id=' + userID);
                if (!response.ok) {
                    throw new Error('Unable to obtain order information');
                }
                const data = await response.json();
                displayOrders(data.orders);
            } catch (error) {
                document.getElementById('error-message').textContent = error.message;
            }
        }

        function displayOrders(orders) {
            const ordersDiv = document.getElementById('orders');
            ordersDiv.innerHTML = '';
            if (orders.length === 0) {
                ordersDiv.innerHTML = '<p>No orders available„ÄÇ</p>';
                return;
            }

            orders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.className = 'order';
                orderDiv.innerHTML = `<strong>order ID:</strong> ${order.id} <br> <strong>status:</strong> ${order.status}`;
                ordersDiv.appendChild(orderDiv);
            });
        }

        window.onload = fetchOrders;
    </script>

    <nav class="bottom-navi-bar">
        <a href="/restaurantList/restaurantList.html" class="nav-item active">
            <span class="icon">üè†</span>
            <span class="label">Home</span>
        </a>
        <a href="/order_tracking/OrderStatus.html" class="nav-item">
            <span class="icon">üìú</span>
            <span class="label">Orders</span>
        </a>
        <a href="/" class="nav-item" id="logout">
            <span class="icon">üë§</span>
            <span class="label">Logout</span>
        </a>
    </nav>
</body>
</html>